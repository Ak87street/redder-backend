<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Redder Dashboard</title>
    <style>
        body { font-family: sans-serif; padding: 20px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        th { background-color: #800000; color: white; }
        .btn-delete { background-color: red; color: white; border: none; padding: 5px 10px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>Order Dashboard</h1>
    <table>
        <thead>
            <tr>
                <th>Date</th>
                <th>Customer</th>
                <th>Address</th>
                <th>Items</th>
                <th>Total</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody id="order-table">
            </tbody>
    </table>

    <script>
        async function loadOrders() {
            // UPDATED: No localhost
            const response = await fetch('/api/orders');
            const orders = await response.json();
            
            const table = document.getElementById('order-table');
            table.innerHTML = '';

            orders.forEach(order => {
                const date = new Date(order.date).toLocaleDateString();
                const itemsList = order.items.map(i => i.name).join(", ");
                
                const row = `<tr>
                    <td>${date}</td>
                    <td>${order.customerName}<br><small>${order.phone}</small></td>
                    <td>${order.address}</td>
                    <td>${itemsList}</td>
                    <td>â‚¹${order.totalAmount}</td>
                    <td><button class="btn-delete" onclick="deleteOrder('${order._id}')">Done/Delete</button></td>
                </tr>`;
                table.innerHTML += row;
            });
        }

        async function deleteOrder(id) {
            if(confirm("Mark this order as complete/delete?")) {
                // UPDATED: No localhost
                await fetch(`/api/orders/${id}`, { method: 'DELETE' });
                loadOrders();
            }
        }

        loadOrders();
    </script>
</body>
</html>