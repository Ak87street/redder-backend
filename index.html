<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>REDDER | Luxury Ethnic Narrative</title>
    <meta name="description" content="Gurgaon's premiere designer house for Indian ladies suits, co-ord sets, and ethnic wear.">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,700;1,400&family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        body { font-family: 'Montserrat', sans-serif; background-color: #fff; color: #1a1a1a; overflow-x: hidden; }
        .font-serif { font-family: 'Playfair Display', serif; }
        
        .reveal { opacity: 0; transform: translateY(15px); transition: all 0.5s cubic-bezier(0.22, 1, 0.36, 1); }
        .reveal.active { opacity: 1; transform: translateY(0); }

        .modal { transition: visibility 0.3s, opacity 0.3s ease; visibility: hidden; opacity: 0; }
        .modal.active { visibility: visible; opacity: 1; }
        
        .slide-panel { transform: translateX(100%); transition: transform 0.4s cubic-bezier(0.7, 0, 0.3, 1); }
        .slide-panel-left { transform: translateX(-100%); transition: transform 0.4s cubic-bezier(0.7, 0, 0.3, 1); }
        .modal.active .slide-panel { transform: translateX(0); }
        .modal.active .slide-panel-left { transform: translateX(0); }

        .btn-primary { background: #b91c1c; color: white; transition: all 0.2s; border: 1px solid #b91c1c; }
        .btn-primary:hover { background: #fff; color: #b91c1c; }
        
        .size-btn { border: 1px solid #e5e7eb; transition: 0.2s; }
        .size-btn.selected { border-color: #b91c1c; color: #b91c1c; font-weight: 700; background: #fff5f5; }
        .size-btn:disabled { opacity: 0.2; text-decoration: line-through; cursor: not-allowed; }

        .nav-scrolled { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); height: 60px !important; border-bottom: 1px solid #f3f4f6; }
        .like-btn { transition: transform 0.2s; }
        .like-btn:active { transform: scale(1.3); }
        .liked { color: #b91c1c !important; }
        .sold-out-overlay { filter: grayscale(100%) opacity(0.6); pointer-events: none; }
        
        .scrollbar-thin::-webkit-scrollbar { width: 4px; }
        .scrollbar-thin::-webkit-scrollbar-track { background: #f1f1f1; }
        .scrollbar-thin::-webkit-scrollbar-thumb { background: #d1d5db; border-radius: 2px; }
        .scrollbar-thin::-webkit-scrollbar-thumb:hover { background: #b91c1c; }
        
        /* Image Placeholder Logic */
        img[alt]:after { display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-color: #f0f0f0; content: 'Image Not Found'; text-align: center; padding-top: 50%; color: red; font-size: 10px; }

        .carousel-dot { width: 6px; height: 6px; border-radius: 50%; background: #ddd; transition: 0.3s; cursor: pointer; }
        .carousel-dot.active { background: #b91c1c; width: 20px; border-radius: 10px; }
    </style>
</head>

<body>
    <nav id="navbar" class="fixed top-0 w-full z-50 h-16 flex items-center justify-between px-6 md:px-12 transition-all duration-500 border-b border-transparent bg-white/95 backdrop-blur-md">
        <div class="flex items-center gap-4">
            <button onclick="toggleMobileMenu()" class="lg:hidden text-lg text-stone-700 hover:text-[#b91c1c]"><i class="fa-solid fa-bars"></i></button>
            <div class="text-2xl font-serif font-bold text-[#b91c1c] tracking-tighter cursor-pointer flex-shrink-0" onclick="window.scrollTo(0,0)">
                REDDER<span class="text-stone-300">.</span>
            </div>
        </div>
        
        <div class="flex items-center gap-6">
            <button onclick="toggleLoginModal()" class="hidden md:block text-[9px] font-bold uppercase tracking-widest hover:text-[#b91c1c]">Identity</button>
            <button onclick="toggleFavModal()" class="relative group p-1">
                <i class="fa-regular fa-heart text-xl hover:text-[#b91c1c] transition-colors"></i>
                <span id="fav-count-badge" class="absolute -top-1 -right-1 bg-[#b91c1c] text-white text-[7px] w-3 h-3 rounded-full flex items-center justify-center opacity-0 transition-opacity">0</span>
            </button>
            <button onclick="toggleCartModal()" class="relative group p-1">
                <i class="fa-solid fa-shopping-bag text-xl hover:text-[#b91c1c] transition-colors"></i>
                <span id="cart-count" class="absolute -top-1 -right-1 bg-[#b91c1c] text-white text-[7px] w-3 h-3 rounded-full flex items-center justify-center opacity-0 transition-opacity">0</span>
            </button>
        </div>
    </nav>

    <div id="mobile-menu" class="modal fixed inset-0 z-[100] flex justify-start bg-black/30 backdrop-blur-sm">
        <div class="slide-panel-left bg-white w-[80%] max-w-xs h-full p-8 flex flex-col shadow-2xl relative">
            <button onclick="toggleMobileMenu()" class="absolute top-6 right-6 text-2xl font-light">&times;</button>
            <div class="text-3xl font-serif font-bold text-[#b91c1c] mb-12">REDDER.</div>
            <div class="flex flex-col gap-6 text-[10px] font-bold uppercase tracking-[0.2em]">
                <button onclick="toggleMobileMenu(); document.getElementById('collections').scrollIntoView()" class="text-left py-2 border-b border-stone-100">Shop Collection</button>
                <button onclick="toggleMobileMenu(); toggleLoginModal()" class="text-left py-2 border-b border-stone-100">My Identity</button>
                <button onclick="toggleMobileMenu(); openPolicy('return')" class="text-left py-2 border-b border-stone-100">Returns</button>
                <button onclick="toggleMobileMenu(); openGeneralChat()" class="text-left py-2 border-b border-stone-100">Concierge Chat</button>
            </div>
        </div>
    </div>

    <section class="h-[35vh] min-h-[300px] flex items-center justify-center bg-stone-50 overflow-hidden relative mt-16">
        <div class="z-10 text-center reveal active">
            <h1 class="text-4xl md:text-6xl font-serif italic mb-3 leading-tight">Boldly <span class="text-[#b91c1c]">Redder.</span></h1>
            <p class="text-stone-400 text-[9px] uppercase tracking-[0.4em] mb-6">Gurgaon's Premiere Designer House</p>
            <button onclick="document.getElementById('collections').scrollIntoView()" class="btn-primary px-8 py-3 text-[9px] font-bold uppercase tracking-[0.2em]">View Selection</button>
        </div>
    </section>

    <section id="collections" class="px-6 md:px-12 py-6 flex flex-col lg:flex-row justify-between items-center gap-6 border-b sticky top-16 bg-white/95 backdrop-blur-md z-40 transition-all">
        <div class="flex gap-8 text-[9px] font-bold uppercase tracking-widest w-full lg:w-auto justify-center lg:justify-start">
            <button onclick="filterProducts('All')" class="filter-btn text-[#b91c1c] border-b-2 border-[#b91c1c] pb-1">All</button>
            <button onclick="filterProducts('Suits')" class="filter-btn text-stone-300 hover:text-black">Suits</button>
            <button onclick="filterProducts('Co-ords')" class="filter-btn text-stone-400 hover:text-black">Co-ords</button>
        </div>

        <div class="flex items-center gap-6 w-full lg:w-auto justify-between lg:justify-end">
            <div class="relative group w-full lg:w-auto">
                <i class="fa-solid fa-search absolute left-3 top-1/2 -translate-y-1/2 text-stone-400 text-xs z-10"></i>
                <input type="text" oninput="handleSearch(this.value)" placeholder="SEARCH NARRATIVE..." class="w-full lg:w-64 pl-9 pr-4 py-2 bg-stone-50 text-[9px] font-bold uppercase tracking-widest border border-transparent focus:border-[#b91c1c] outline-none rounded-sm transition-all">
            </div>
            <select onchange="handleSort(this.value)" class="bg-transparent text-[9px] font-bold uppercase outline-none cursor-pointer flex-shrink-0">
                <option value="featured">Featured</option>
                <option value="lowhigh">Price: Low - High</option>
                <option value="highlow">Price: High - Low</option>
            </select>
        </div>
    </section>

    <main class="px-6 md:px-12 py-8">
        <div id="product-grid" class="grid grid-cols-2 lg:grid-cols-4 gap-x-6 gap-y-10"></div>
    </main>

    <footer class="bg-[#111] text-white py-12 px-12 text-center border-t border-stone-800">
        <div class="text-2xl font-serif font-bold text-[#b91c1c] mb-4 uppercase">REDDER.</div>
        <div class="flex justify-center gap-8 mb-8 text-[9px] font-bold uppercase tracking-widest text-stone-400">
            <button onclick="openPolicy('return')" class="hover:text-white border-b border-transparent hover:border-white pb-1">Return Policy</button>
            <button onclick="openPolicy('privacy')" class="hover:text-white border-b border-transparent hover:border-white pb-1">Privacy Policy</button>
        </div>
        <p class="text-[8px] uppercase tracking-[0.3em] opacity-30 mb-8">Â© 2025 Gurgaon House. Secure Concierge Protocol.</p>
        <div class="flex justify-center gap-8 text-xl opacity-60">
            <i class="fa-brands fa-whatsapp hover:text-[#b91c1c] cursor-pointer" onclick="openGeneralChat()"></i>
            <i class="fa-brands fa-instagram hover:text-[#b91c1c]"></i>
        </div>
    </footer>

    <div id="product-modal" class="modal fixed inset-0 z-[100] flex items-center justify-center bg-white/95 backdrop-blur-2xl p-4">
        <div class="max-w-4xl w-full flex flex-col md:flex-row items-center gap-10 p-6 relative bg-white rounded-xl shadow-2xl h-[90vh] md:h-auto overflow-y-auto">
            <button onclick="closeProductModal()" class="absolute top-4 right-4 text-3xl font-light hover:text-[#b91c1c] z-50">&times;</button>
            
            <div class="md:w-1/2 w-full aspect-[3/4] relative bg-stone-50 rounded-lg overflow-hidden group">
                <img id="modal-img" src="" class="w-full h-full object-cover transition-transform duration-500">
                <div id="modal-soldout-badge" class="hidden absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-black text-white text-xs font-bold px-4 py-2 uppercase tracking-[0.2em] border border-white z-20">Sold Out</div>
                <button id="prev-arrow" onclick="changeSlide(-1)" class="carousel-control absolute left-2 top-1/2 -translate-y-1/2 bg-white/80 p-2 rounded-full hover:bg-white text-stone-800 hidden"><i class="fa-solid fa-chevron-left"></i></button>
                <button id="next-arrow" onclick="changeSlide(1)" class="carousel-control absolute right-2 top-1/2 -translate-y-1/2 bg-white/80 p-2 rounded-full hover:bg-white text-stone-800 hidden"><i class="fa-solid fa-chevron-right"></i></button>
                <div id="carousel-dots" class="absolute bottom-4 left-0 w-full flex justify-center gap-2"></div>
            </div>

            <div class="md:w-1/2 w-full">
                <span id="modal-tag" class="text-[9px] font-bold text-[#b91c1c] uppercase tracking-[0.3em] mb-2 block"></span>
                <h3 id="modal-title" class="text-3xl md:text-4xl font-serif font-bold mb-4 italic text-slate-900 leading-tight"></h3>
                <div id="modal-price-container" class="mb-6"><p id="modal-price" class="flex items-baseline"></p></div>
                <div class="mb-6 border-l-2 border-stone-100 pl-4"><p id="modal-desc" class="text-stone-500 text-xs leading-relaxed max-h-[150px] overflow-y-auto pr-2 scrollbar-thin whitespace-pre-wrap"></p></div>
                <div class="mb-8">
                    <div class="flex justify-between items-center mb-4">
                        <label class="text-[9px] font-bold uppercase tracking-widest text-stone-400">Select Narrative Size</label>
                        <button onclick="toggleSizeGuide()" class="text-[9px] font-bold uppercase tracking-widest text-[#b91c1c] underline">Size Guide</button>
                    </div>
                    <div id="modal-sizes" class="flex flex-wrap gap-3"></div>
                </div>
                <button id="modal-add-btn" disabled class="btn-primary w-full py-4 text-[9px] font-bold uppercase tracking-[0.3em] disabled:bg-stone-100 disabled:text-stone-300 rounded-sm">Bag Selection</button>
            </div>
        </div>
    </div>

    <div id="size-guide-modal" class="modal fixed inset-0 z-[120] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4">
        <div class="bg-white p-8 rounded-lg max-w-sm w-full text-center relative">
            <button onclick="toggleSizeGuide()" class="absolute top-4 right-4 text-2xl">&times;</button>
            <h3 class="text-xl font-serif italic mb-6">Standard Chart (Inches)</h3>
            <div class="grid grid-cols-4 gap-4 text-xs font-bold border-b pb-2 mb-2"><span>Size</span><span>Bust</span><span>Waist</span><span>Hip</span></div>
            <div class="grid grid-cols-4 gap-4 text-xs text-stone-600 mb-2"><span>S</span><span>36</span><span>32</span><span>38</span></div>
            <div class="grid grid-cols-4 gap-4 text-xs text-stone-600 mb-2"><span>M</span><span>38</span><span>34</span><span>40</span></div>
            <div class="grid grid-cols-4 gap-4 text-xs text-stone-600 mb-2"><span>L</span><span>40</span><span>36</span><span>42</span></div>
            <div class="grid grid-cols-4 gap-4 text-xs text-stone-600"><span>XL</span><span>42</span><span>38</span><span>44</span></div>
        </div>
    </div>

    <div id="fav-modal" class="modal fixed inset-0 z-[100] flex justify-end bg-black/30 backdrop-blur-sm">
        <div class="slide-panel bg-white w-full max-w-md h-full p-8 flex flex-col shadow-2xl">
            <div class="flex justify-between items-end mb-8 border-b pb-4 text-[#b91c1c]">
                <h3 class="text-2xl font-serif italic">Favorites</h3>
                <button onclick="toggleFavModal()" class="text-2xl font-light">&times;</button>
            </div>
            <div id="fav-items" class="flex-1 overflow-y-auto space-y-6"></div>
        </div>
    </div>

    <div id="cart-modal" class="modal fixed inset-0 z-[100] flex justify-end bg-black/30 backdrop-blur-sm">
        <div class="slide-panel bg-white w-full max-w-md h-full p-8 flex flex-col shadow-2xl">
            <div class="flex justify-between items-end mb-8 border-b pb-4 text-[#b91c1c]">
                <h3 class="text-2xl font-serif italic">Your Bag</h3>
                <button onclick="toggleCartModal()" class="text-2xl font-light">&times;</button>
            </div>
            <div class="mb-8">
                <div class="bg-stone-100 h-[2px] w-full relative"><div id="shipping-bar" class="absolute top-0 left-0 bg-[#b91c1c] h-full progress-bar" style="width:0%"></div></div>
                <p id="shipping-msg" class="text-[8px] uppercase tracking-widest text-center mt-2 text-stone-400 font-bold"></p>
            </div>
            <div id="cart-items" class="flex-1 overflow-y-auto space-y-6"></div>
            <div class="pt-8 border-t space-y-4">
                <input type="text" id="coupon-input" placeholder="CODE / REFUND" class="w-full bg-stone-50 border-none px-4 py-3 text-[9px] uppercase font-bold outline-none focus:ring-1 ring-[#b91c1c] rounded-sm">
                <button onclick="applyCoupon()" class="text-[9px] font-bold uppercase border-b border-black pb-1">Apply Code</button>
                <div class="flex justify-between text-xl font-serif italic pt-4 border-t border-stone-50"><span>Total</span><span id="cart-total">â‚¹0</span></div>
                <button onclick="checkout()" class="w-full py-4 bg-[#b91c1c] text-white text-[9px] font-bold uppercase tracking-[0.4em] shadow-xl rounded-sm">Confirm Order</button>
            </div>
        </div>
    </div>

    <div id="policy-modal" class="modal fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4">
        <div class="bg-white max-w-lg w-full p-8 rounded-lg relative">
            <button onclick="closePolicy()" class="absolute top-4 right-4 text-2xl">&times;</button>
            <h3 class="text-2xl font-serif italic mb-6 text-[#b91c1c]">Policy Detail</h3>
            <pre id="policy-text" class="whitespace-pre-wrap font-sans text-xs leading-relaxed text-stone-600"></pre>
        </div>
    </div>

    <div id="login-modal" class="modal fixed inset-0 z-[100] flex items-center justify-center bg-white/95 backdrop-blur-xl p-4">
        <div class="max-w-xs w-full text-center">
            <button onclick="toggleLoginModal()" class="fixed top-8 right-8 text-3xl font-light hover:text-[#b91c1c]">&times;</button>
            <h3 class="text-4xl font-serif italic mb-10 text-[#b91c1c]">Identity.</h3>
            <form onsubmit="handleLogin(event)" class="space-y-6">
                <input type="text" id="user-name" required placeholder="FULL NAME" class="w-full bg-transparent border-b border-stone-200 py-3 text-[9px] font-bold outline-none focus:border-[#b91c1c]">
                <input type="tel" id="user-phone" required placeholder="WHATSAPP NUMBER" class="w-full bg-transparent border-b border-stone-200 py-3 text-[9px] font-bold outline-none focus:border-[#b91c1c]">
                <textarea id="user-address" required placeholder="SHIPPING ADDRESS" class="w-full bg-transparent border-b border-stone-200 py-3 text-[9px] font-bold outline-none focus:border-[#b91c1c] h-20"></textarea>
                <button type="submit" class="btn-primary w-full py-4 text-[9px] font-bold uppercase tracking-[0.3em] rounded-sm">Secure Profile</button>
            </form>
        </div>
    </div>

    <script>
        // =================================================================
        // ðŸ›ï¸ MASTER COLLECTION (YOUR 21 PRODUCTS ARE HERE)
        // =================================================================
        const MY_COLLECTION = [
            { id: 1, name: "Peplum Top with Palazzo set", price: "â‚¹900", mrp: "â‚¹1,499", rawPrice: 900, category: "Co-ords", imageBase: "sub/1", gallery: ["sub/1_back", "sub/1_close"], tag: "Bestseller", description: `This is our signature bestseller...`, sizeStock: { "S": 0, "M": 1, "L": 1, "XL": 0 } },
            { id: 2, name: "Thread work chanderi silk kurta set.", price: "â‚¹1,700", mrp: "â‚¹2,899", rawPrice: 1700, category: "Suits", imageBase: "sub/2", gallery: ["sub/2_back"], tag: "New", description: `Thread work chanderi silk kurta set...`, sizeStock: { "S": 0, "M": 1, "L": 1, "XL": 0 } },
            { id: 3, name: "Regalia in Maroon: Chanderi Kurta Set", price: "â‚¹2,000", mrp: "â‚¹3,499", rawPrice: 2000, category: "Suits", imageBase: "sub/3", tag: "New", description: `Make an elegant statement...`, sizeStock: { "S": 0, "M": 1, "L": 1, "XL": 0 } },
            { id: 4, name: "Pink & Gold Chanderi Silk Embroidered Set", price: "â‚¹2,000", mrp: "â‚¹3,250", rawPrice: 2000, category: "Suits", imageBase: "sub/4", tag: "Bestseller", description: `Make a graceful style statement...`, sizeStock: { "S": 0, "M": 1, "L": 1, "XL": 0 } },
            { id: 5, name: "Mustard Silk Blend Embroidered Kurta Set", price: "â‚¹1,800", mrp: "â‚¹2,999", rawPrice: 1800, category: "Suits", imageBase: "sub/5", tag: "Trending", description: `Add a touch of timeless elegance...`, sizeStock: { "S": 0, "M": 1, "L": 1, "XL": 0 } },
            { id: 6, name: "Pink Silk Blend Embroidered Kurta Set", price: "â‚¹1,800", mrp: "â‚¹2,999", rawPrice: 1800, category: "Suits", imageBase: "sub/6", tag: "Trending", description: `Elevate your ethnic style...`, sizeStock: { "S": 0, "M": 1, "L": 1, "XL": 0 } },
            { id: 7, name: "Black & White Foil Printed Georgette Anarkali", price: "â‚¹2,000", mrp: "â‚¹3,500", rawPrice: 2000, category: "Suits", imageBase: "sub/7", tag: "New", description: `Step into effortless elegance...`, sizeStock: { "S": 0, "M": 1, "L": 1, "XL": 0 } },
            { id: 8, name: "Yellow Cotton Embroidered A-Line Kurta Set", price: "â‚¹2,000", mrp: "â‚¹2,800", rawPrice: 2000, category: "Suits", imageBase: "sub/8", tag: "Festive", description: `Brighten up your wardrobe...`, sizeStock: { "S": 0, "M": 1, "L": 1, "XL": 0 } },
            { id: 9, name: "Black Crepe Top & Pant Set with Jacket", price: "â‚¹960", mrp: "â‚¹1,599", rawPrice: 960, category: "Co-ords", imageBase: "sub/9", tag: "Bestseller", description: `Elevate your contemporary wardrobe...`, sizeStock: { "S": 0, "M": 1, "L": 1, "XL": 0 } },
            { id: 10, name: "Off-White Chanderi Straight Kurta Sharara", price: "â‚¹2,500", mrp: "â‚¹4,200", rawPrice: 2500, category: "Suits", imageBase: "sub/10", tag: "Festive", description: `Add timeless festive elegance...`, sizeStock: { "S": 0, "M": 1, "L": 1, "XL": 0 } },
            { id: 11, name: "Maroon Pure Cotton Printed Co-Ord Set", price: "â‚¹1,000", mrp: "â‚¹1,850", rawPrice: 1000, category: "Co-ords", imageBase: "sub/11", tag: "Essential", description: `Step into effortless elegance...`, sizeStock: { "S": 0, "M": 1, "L": 1, "XL": 0 } },
            { id: 12, name: "Black Floral Cotton Co-Ord Set", price: "â‚¹1,000", mrp: "â‚¹1,850", rawPrice: 1000, category: "Co-ords", imageBase: "sub/12", tag: "Essential", description: `Elevate your everyday wardrobe...`, sizeStock: { "S": 0, "M": 1, "L": 1, "XL": 0 } },
            { id: 13, name: "Maroon Linen Cotton Co-Ord Set", price: "â‚¹1,300", mrp: "â‚¹2,100", rawPrice: 1300, category: "Co-ords", imageBase: "sub/13", tag: "New", description: `Step into effortless elegance...`, sizeStock: { "S": 0, "M": 1, "L": 1, "XL": 0 } },
            { id: 14, name: "Peach Cotton Blend Floral Printed Kurta Set", price: "â‚¹1,150", mrp: "â‚¹1,999", rawPrice: 1150, category: "Suits", imageBase: "sub/14", tag: "New", description: `Add a touch of effortless charm...`, sizeStock: { "S": 0, "M": 1, "L": 1, "XL": 0 } },
            { id: 15, name: "Yellow Cotton Blend Floral Printed Kurta Set", price: "â‚¹1,200", mrp: "â‚¹2,050", rawPrice: 1200, category: "Suits", imageBase: "sub/15", tag: "Classic", description: `Brighten up your ethnic wardrobe...`, sizeStock: { "S": 0, "M": 1, "L": 1, "XL": 0 } },
            { id: 16, name: "Off White Cotton Blend Floral Printed Kurta Set", price: "â‚¹1,200", mrp: "â‚¹2,050", rawPrice: 1200, category: "Suits", imageBase: "sub/16", tag: "Classic", description: `Elevate your ethnic wardrobe...`, sizeStock: { "S": 0, "M": 1, "L": 1, "XL": 0 } },
            { id: 17, name: "Green Cotton Blend Floral Printed Anarkali", price: "â‚¹1,350", mrp: "â‚¹2,299", rawPrice: 1350, category: "Suits", imageBase: "sub/17", tag: "Festive", description: `Bring timeless elegance...`, sizeStock: { "S": 0, "M": 1, "L": 1, "XL": 0 } },
            { id: 18, name: "Orange Cotton Blend Floral Printed Kurta Set", price: "â‚¹1,150", mrp: "â‚¹1,999", rawPrice: 1150, category: "Suits", imageBase: "sub/18", tag: "Classic", description: `Add a pop of colour...`, sizeStock: { "S": 0, "M": 1, "L": 1, "XL": 0 } },
            { id: 19, name: "Yellow Embroidered Silk Blend Kurta Set", price: "â‚¹1,250", mrp: "â‚¹2,499", rawPrice: 1250, category: "Suits", imageBase: "sub/19", tag: "Casual", description: `Add a touch of festive elegance...`, sizeStock: { "S": 0, "M": 1, "L": 1, "XL": 0 } },
            { id: 20, name: "Bottle Green Silk Blend Embroidered Kurta Set", price: "â‚¹1,450", mrp: "â‚¹2,899", rawPrice: 1450, category: "Suits", imageBase: "sub/20", tag: "Festive", description: `Make a statement of timeless elegance...`, sizeStock: { "S": 0, "M": 1, "L": 1, "XL": 0 } },
            { id: 21, name: "Mehreen Silver Mauve Crepe Suit Set", price: "â‚¹2,700", mrp: "â‚¹4,500", rawPrice: 2700, category: "Suits", imageBase: "sub/21", tag: "Luxury", description: `Introducing the Mehreen Suit Set...`, sizeStock: { "S": 0, "M": 1, "L": 1, "XL": 0 } }
        ];

        const COUPONS = { "WELCOME10": 0.10, "REDDER500": 500 };
        const CONFIG = { whatsappNumber: "918527007740", freeShippingThreshold: 1999 };
        const POLICIES = {
            return: "RETURN POLICY\n\n1. Returns are accepted within 7 days of delivery.\n2. Items must be unused with tags intact.\n3. Refunds are processed as Store Credit within 48 hours of pickup.\n4. Sale items are final.",
            privacy: "PRIVACY POLICY\n\n1. We prioritize your privacy.\n2. Your phone number is used strictly for order updates.\n3. We do not share data with third parties."
        };

        let cart = [], favs = [], currentUser = null;
        let currentFilter = 'All', currentSort = 'featured', activeIdx = null, selectedSize = null, appliedDiscount = 0, searchTerm = '';
        let currentSlide = 0, slideImages = [];

        window.addEventListener('scroll', () => {
            const nav = document.getElementById('navbar');
            if(window.scrollY > 20) nav.classList.add('nav-scrolled'); else nav.classList.remove('nav-scrolled');
            document.querySelectorAll('.reveal').forEach(el => { if(el.getBoundingClientRect().top < window.innerHeight - 100) el.classList.add('active'); });
        });

        function imageError(img) {
            const currentSrc = img.src;
            if (currentSrc.endsWith('.jpg')) img.src = currentSrc.replace('.jpg', '.png');
            else if (currentSrc.endsWith('.png')) img.src = currentSrc.replace('.png', '.jpeg');
            else if (currentSrc.endsWith('.jpeg')) img.src = currentSrc.replace('.jpeg', '.JPG');
            else { img.src = 'https://via.placeholder.com/800x1100?text=Check+File+Name'; }
        }

        function init() {
            const saved = localStorage.getItem('redderUser'); if(saved) { currentUser = JSON.parse(saved); }
            const savedFavs = localStorage.getItem('redderFavs'); if(savedFavs) { favs = JSON.parse(savedFavs); updateFavUI(); }
            renderProducts(); // Directly render (no fetch)
        }

        function handleSort(val) { currentSort = val; renderProducts(); }
        function handleSearch(val) { searchTerm = val.toLowerCase(); renderProducts(); }
        function filterProducts(c) {
            currentFilter = c;
            document.querySelectorAll('.filter-btn').forEach(b => {
                if(b.innerText === c) b.classList.add('text-[#b91c1c]', 'border-b-2', 'border-[#b91c1c]');
                else b.classList.remove('text-[#b91c1c]', 'border-b-2', 'border-[#b91c1c]');
            });
            renderProducts();
        }

        function renderProducts() {
            const grid = document.getElementById('product-grid'); grid.innerHTML = '';
            let items = [...MY_COLLECTION];
            if(currentFilter !== 'All') items = items.filter(i => i.category === currentFilter);
            if(searchTerm) items = items.filter(i => i.name.toLowerCase().includes(searchTerm) || i.category.toLowerCase().includes(searchTerm));
            if(currentSort === 'lowhigh') items.sort((a,b) => a.rawPrice - b.rawPrice);
            else if(currentSort === 'highlow') items.sort((a,b) => b.rawPrice - a.rawPrice);

            items.forEach((p, idx) => {
                // IMPORTANT: Append .jpg to match your file structure
                const imgSrc = p.imageBase + ".jpg";
                const isFav = favs.includes(p.id);
                const totalStock = Object.values(p.sizeStock).reduce((a,b) => a+b, 0);
                const isSoldOut = totalStock === 0;
                const priceDisplay = p.mrp ? `<span class="text-[10px] text-stone-400 line-through mr-2">${p.mrp}</span><span class="text-xs font-bold tracking-[0.1em] text-[#b91c1c]">${p.price}</span>` : `<span class="text-xs font-bold tracking-[0.1em] text-[#b91c1c]">${p.price}</span>`;
                const imgClass = isSoldOut ? 'sold-out-overlay' : 'group-hover:scale-105';
                const badge = isSoldOut ? `<div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-black/80 text-white text-[9px] font-bold px-3 py-2 uppercase tracking-widest border border-white z-20">Sold Out</div>` : '';

                grid.innerHTML += `<div class="reveal active group cursor-pointer" style="transition-delay: ${idx * 0.05}s"><div class="relative aspect-[3/4] overflow-hidden bg-stone-50 mb-4 rounded-sm" onclick="openProductModal(${MY_COLLECTION.indexOf(p)})"><img src="${imgSrc}" class="w-full h-full object-cover transition-transform duration-[1s] ${imgClass}" onerror="imageError(this)">${badge}<div class="absolute top-3 left-3 bg-[#b91c1c] text-white text-[7px] font-bold px-2 py-1 uppercase tracking-widest ${isSoldOut ? 'hidden' : ''}">${p.tag}</div><button onclick="event.stopPropagation(); toggleFav(${p.id})" class="absolute top-3 right-3 text-lg like-btn ${isFav ? 'liked' : 'text-stone-400'}"><i class="${isFav ? 'fa-solid' : 'fa-regular'} fa-heart"></i></button></div><h3 class="font-serif italic text-lg text-stone-900 group-hover:text-[#b91c1c] transition-colors mb-1 truncate">${p.name}</h3><p class="text-[8px] tracking-widest text-stone-300 font-bold uppercase mb-1">${p.category}</p><div class="flex items-center">${priceDisplay}</div></div>`;
            });
            if(items.length === 0) grid.innerHTML = `<div class="col-span-4 text-center py-20 text-stone-300 font-serif italic text-2xl">Narrative not found.</div>`;
        }

        function toggleFav(id) {
            if(favs.includes(id)) favs = favs.filter(i => i !== id); else favs.push(id);
            localStorage.setItem('redderFavs', JSON.stringify(favs)); updateFavUI(); renderProducts(); 
        }

        function updateFavUI() {
            const count = favs.length;
            document.getElementById('fav-count-badge').innerText = count; 
            document.getElementById('fav-count-badge').style.opacity = count > 0 ? '1' : '0';
            const list = document.getElementById('fav-items');
            list.innerHTML = count === 0 ? '<p class="text-center text-xs text-stone-400">No favorites yet.</p>' : '';
            favs.forEach(fid => {
                const item = MY_COLLECTION.find(p => p.id === fid);
                if(item) { list.innerHTML += `<div class="flex gap-4 items-center"><img src="${item.imageBase}.jpg" class="w-12 h-16 object-cover rounded-sm" onerror="imageError(this)"><div class="flex-1"><h4 class="font-serif italic text-sm">${item.name}</h4><p class="text-[9px] font-bold text-[#b91c1c]">${item.price}</p></div><button onclick="toggleFav(${item.id})" class="text-stone-400 hover:text-red-600"><i class="fa-solid fa-xmark"></i></button></div>`; }
            });
        }

        function openProductModal(idx) {
            const p = MY_COLLECTION[idx]; activeIdx = idx; selectedSize = null;
            
            // GALLERY LOGIC
            slideImages = [p.imageBase + ".jpg"]; 
            if (p.gallery) { p.gallery.forEach(img => slideImages.push(img + ".jpg")); }
            currentSlide = 0; updateSlide();
            
            const showControls = slideImages.length > 1;
            document.getElementById('prev-arrow').style.display = showControls ? 'block' : 'none';
            document.getElementById('next-arrow').style.display = showControls ? 'block' : 'none';

            const totalStock = Object.values(p.sizeStock).reduce((a,b) => a+b, 0);
            const isSoldOut = totalStock === 0;
            const imgEl = document.getElementById('modal-img');
            
            if(isSoldOut) { imgEl.classList.add('sold-out-overlay'); document.getElementById('modal-soldout-badge').classList.remove('hidden'); } 
            else { imgEl.classList.remove('sold-out-overlay'); document.getElementById('modal-soldout-badge').classList.add('hidden'); }

            document.getElementById('modal-title').innerText = p.name;
            const priceEl = document.getElementById('modal-price');
            if (p.mrp) { priceEl.innerHTML = `<span class="text-stone-400 line-through text-lg mr-3 font-light">${p.mrp}</span> <span class="text-2xl font-bold text-[#b91c1c]">${p.price}</span>`; } 
            else { priceEl.innerHTML = `<span class="text-2xl font-bold text-[#b91c1c]">${p.price}</span>`; }

            document.getElementById('modal-desc').innerText = p.description;
            document.getElementById('modal-tag').innerText = p.tag;
            const sc = document.getElementById('modal-sizes'); sc.innerHTML = '';
            
            Object.keys(p.sizeStock).forEach(size => {
                const stock = p.sizeStock[size]; const isOut = stock <= 0;
                sc.innerHTML += `<button onclick="selectSize(this, '${size}')" class="size-btn w-12 h-12 text-[9px] font-bold relative rounded-sm ${isOut ? 'disabled' : ''}" ${isOut ? 'disabled' : ''}>${size}</button>`;
            });

            const btn = document.getElementById('modal-add-btn');
            if(isSoldOut) { btn.innerText = "SOLD OUT"; btn.disabled = true; btn.style.opacity = "0.5"; } 
            else { btn.innerText = "BAG SELECTION"; btn.disabled = true; btn.style.opacity = "1"; }
            document.getElementById('product-modal').classList.add('active');
        }

        function changeSlide(dir) {
            currentSlide += dir;
            if(currentSlide < 0) currentSlide = slideImages.length - 1;
            if(currentSlide >= slideImages.length) currentSlide = 0;
            updateSlide();
        }

        function updateSlide() {
            document.getElementById('modal-img').src = slideImages[currentSlide];
            const dots = document.getElementById('carousel-dots');
            dots.innerHTML = '';
            if(slideImages.length > 1) {
                slideImages.forEach((_, i) => {
                    dots.innerHTML += `<div class="carousel-dot ${i === currentSlide ? 'active' : ''}" onclick="currentSlide=${i}; updateSlide()"></div>`;
                });
            }
        }

        function selectSize(btn, s) {
            if(btn.disabled) return;
            selectedSize = s;
            document.querySelectorAll('.size-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
            document.getElementById('modal-add-btn').disabled = false;
        }

        function updateCartUI() {
            const count = cart.length;
            document.getElementById('cart-count').innerText = count; document.getElementById('cart-count').style.opacity = count > 0 ? '1' : '0';
            const list = document.getElementById('cart-items'); list.innerHTML = ''; let sub = 0;
            cart.forEach((item, i) => {
                sub += item.rawPrice;
                const priceHtml = item.mrp ? `<span class="text-[9px] text-stone-400 line-through mr-1">${item.mrp}</span> <span class="text-xs font-bold text-[#b91c1c]">${item.price}</span>` : `<span class="text-xs font-bold text-[#b91c1c]">${item.price}</span>`;
                list.innerHTML += `<div class="flex gap-6"><img src="${item.imageBase + '.jpg'}" class="w-16 aspect-[3/4] object-cover bg-stone-50 rounded-sm" onerror="imageError(this)"><div class="flex-1 text-xs"><h4 class="font-serif italic text-lg">${item.name}</h4><p class="text-[9px] uppercase tracking-widest font-bold text-stone-400 mt-1">Size: ${item.selectedSize}</p><div class="mt-2">${priceHtml}</div><button onclick="removeFromCart(${i})" class="text-[8px] uppercase font-bold mt-4 text-stone-400 hover:text-[#b91c1c] transition-colors block">Remove</button></div></div>`;
            });
            const pct = (sub/CONFIG.freeShippingThreshold)*100;
            document.getElementById('shipping-bar').style.width = Math.min(100, pct) + "%";
            document.getElementById('shipping-msg').innerText = sub < 1999 ? `Add â‚¹${1999-sub} for complimentary protocol` : "Complimentary delivery achieved";
            document.getElementById('cart-total').innerText = "â‚¹" + (sub - appliedDiscount);
        }

        function applyCoupon() {
            const code = document.getElementById('coupon-input').value.trim().toUpperCase();
            if(code.startsWith("REFUND-")) { appliedDiscount = parseInt(code.split('-')[1]) || 0; }
            else if(COUPONS[code]) { appliedDiscount = Math.floor(cart.reduce((s,i)=>s+i.rawPrice,0) * COUPONS[code]); }
            updateCartUI();
        }

        function handleLogin(e) {
            e.preventDefault();
            currentUser = { name: document.getElementById('user-name').value, phone: document.getElementById('user-phone').value, address: document.getElementById('user-address').value };
            localStorage.setItem('redderUser', JSON.stringify(currentUser));
            toggleLoginModal();
        }

        // --- â˜ï¸ CLOUD CHECKOUT ---
        async function checkout() {
            if(!cart.length) return;
            if(!currentUser) return toggleLoginModal();

            const orderData = {
                customerName: currentUser.name,
                address: currentUser.address,
                phone: currentUser.phone,
                items: cart,
                totalAmount: cart.reduce((sum, item) => sum + item.rawPrice, 0)
            };

            try {
                // Post to your new Cloud Backend
                const response = await fetch('/api/orders', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(orderData)
                });

                if (response.ok) {
                    alert("Order Confirmed! Our Concierge will call you shortly.");
                    cart = [];
                    updateCartUI();
                    toggleCartModal();
                } else {
                    alert("Order Failed. Please try again.");
                }
            } catch (err) {
                console.error("Order error", err);
                alert("Server Error.");
            }
        }

        function openPolicy(type) { document.getElementById('policy-text').innerText = POLICIES[type]; document.getElementById('policy-modal').classList.add('active'); }
        function closePolicy() { document.getElementById('policy-modal').classList.remove('active'); }
        function toggleCartModal() { document.getElementById('cart-modal').classList.toggle('active'); }
        function toggleFavModal() { document.getElementById('fav-modal').classList.toggle('active'); }
        function toggleLoginModal() { document.getElementById('login-modal').classList.toggle('active'); }
        function toggleMobileMenu() { document.getElementById('mobile-menu').classList.toggle('active'); }
        function toggleSizeGuide() { document.getElementById('size-guide-modal').classList.toggle('active'); }
        function closeProductModal() { document.getElementById('product-modal').classList.remove('active'); }
        function removeFromCart(i) { cart.splice(i,1); updateCartUI(); }
        function openGeneralChat() { window.open(`https://wa.me/918527007740`); }
        function addToBag() { cart.push({...MY_COLLECTION[activeIdx], selectedSize}); updateCartUI(); closeProductModal(); }
        document.getElementById('modal-add-btn').onclick = addToBag;

        init();
    </script>
</body>
</html>